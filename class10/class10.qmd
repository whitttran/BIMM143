---
title: "class10"
author: "Whitney Tran (PID:A16781338)"
format: pdf
---

# The PDB database

Here we examine the size and composition of the main databse of biomolecular structures - the PDB.

```{r}
pdbstats <- read.csv("Data Export Summary.csv", row.names=1)
head(pdbstats)

```

-   **Q1:** What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

My pdbstats data frame has numbers with commas in them. This may cause us problems. Let's see:

```{r}
as.numeric(pdbstats$X.ray)
```

We found a function called `gsub()`. Now we can figure out how it works.

```{r}
gsub(",", "", pdbstats$X.ray)

as.numeric(gsub(",", "", pdbstats$X.ray))
```

I can turn this snipet into a function that I can use for every column in the table.

```{r}
commasum <- function(x) {
  sum(as.numeric(gsub(",","", x)))
}

commasum(pdbstats$X.ray)
```

```{r}
totals <- apply(pdbstats, 2, commasum)
totals
```

```{r}
round(totals/totals["Total"]*100,2)
```

```{r}
(commasum(pdbstats$X.ray) + commasum(pdbstats$EM)) / commasum(pdbstats$Total)*100
```

93.27% of structures in PDB are solved by X-ray and electron microscopy. (84.54% was solved by X-ray and 8.72% was solved by EM).

-   **Q2:** What proportion of structures in the PDB are protein?

```{r}
prot <-commasum(pdbstats[1:3,7])

tot <- commasum(pdbstats$Total)

(prot/tot)*100

```

97.86% of structures in the PDB are protein.

-   **Q3:** Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?

26,204 structures in the current PDB are HIV-1 proteases.

# 2. Visualizing Protein Structure

We will learn the basics of Mol\* (mol-star) homepage: https://molstar.org/viewer/

We will play with PDB code 1HSG.

> Q4: Water molecules normally have 3 atoms. Why do we see just one atom per water molecule in this structure?

-   The hydrogen atoms are too small to visualize.

> Q5: There is a critical “conserved” water molecule in the binding site. Can you identify this water molecule? What residue number does this water molecule have

-   Its residue number is 308.

>Q6: Generate and save a figure clearly showing the two distinct chains of HIV-protease along with the ligand. You might also consider showing the catalytic residues ASP 25 in each chain and the critical water (we recommend “Ball & Stick” for these side-chains). Add this figure to your Quarto document.

![HIV Pr](1HSG%20(1).png)

![HIV Pr with the two critical ASP residues](1HSG%20(1)%20copy.png)

![HIV Pr with the critical conserved water molecule](1HSG.png)

## Back to R and working with PDB structures

Predict the dynamics (flexibility) of an important protein:

```{r}
library(bio3d)

hiv <- read.pdb("1hsg")
hiv
```

```{r}
head(hiv$atom)
```

```{r}
pdbseq(hiv)
```

Here we will do a Normal Mode Analysis (NMA) to predict functional motions of a kinase protein.

```{r}
adk <- read.pdb("6s36")
adk
```


```{r}
modes <- nma(adk)

plot(modes)
```

Make a "movie" called a trajectory of the predicted motions:

```{r}
mktrj(modes, file="adk_m7.pdb")

```


Then I can open this file in Mol*...











