---
title: "Class 6: R Functions"
author: "Whitney (PID:A16781338)"
date: 01/25/24
format: pdf
---

## R Functions

Functions are how we get stuff done We call functions to do everything useful in R.

One cool thing about R is that it makes writing your own functions comparatively easy.

All functions in R have at least three things:

- A **name** (we get to pick this)
- One or more **input arguments** (the input to our function)
- the **body** (lines or code that do the work)

```{r}
#| eval: false
function(input1,input2){
 the body
}

```

Let's write a silly first function to add two numbers:

```{r}
x<- 5
y<- 1
x+y
```

```{r}
addme <- function(x,y){
  x+y
}
```
```{r}
addme(100,100)
```

##lab for today

```{r}
# Example input vectors to start with
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90)
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
```


Q1. Write a function grade() to determine an overall grade from a vector of student homework
assignment scores dropping the lowest single score. If a student misses a homework (i.e. has an
NA value) this can be used as a score to be potentially dropped. Your final function should be
adquately explained with code comments and be able to work on an example class gradebook
such as this one in CSV format: “https://tinyurl.com/gradeinput” [3pts]
```{r}
mean(student1)
mean(student2,na.rm=TRUE)
mean(student3, na.rm=TRUE)
```

This is not fair- this is no way student3 should have mean of 90!
Come back to this NA prolem. But things worked for `student1`.

We want to drop the lowest score before getting the `mean()`.
How do I find the lowest (minimum score)
```{r}
student1
```
```{r}
min(student1)
```
I found the `which.min()` function. Maybe this is more useful.
```{r}
which.min(student1)
```
Cool - it is the 8th element of the vector that has the lowest score. Can I remove this one?
```{r}
student1[which.min(student1)]
```
We can use the wee minus trick for indexing.
```{r}
x<-1:5
x[-3]
```

```{r}
#find the lowest score
ind <- which.min(student1)
#remove lowest score and find the mean
mean(student1[-ind])

mean(student1[-which.min(student1)])
```
Use a common shortcut and use `x` as my input.
```{r}
x<-student1
mean(x[-which.min(x)])
```

We still have the problem of missing values.

One idea is to replace NA values with 0.
```{r}
y<-1:5
y[y==3] <- 1000
y
```
```{r}
y<-c(1,2,NA,4,5)
y==NA
```
^ bummer this doesn't work.

```{r}
is.na(y)
```
How can I remove the NA elements from the vector?
I first need to flip the TRUE element.
```{r}
!c(F,F,F)
```
```{r}
y[!is.na(y)]
```
```{r}
y[is.na(y)]<-1000
y
```

```{r}
x<- student1
#change NA values to Zero.
x[is.na(x)]<-0
#find and remove min value and get mean.
mean(x[-which.min(x)])
```

last step now that I hae my working code snippet is to make my `grade()` function.
```{r}
grade <- function(x){
  #change NA values to Zero.
x[is.na(x)]<-0
#find and remove min value and get mean.
mean(x[-which.min(x)])}
```
```{r}
grade(student3)
```

Now read the online gradebook (CSV file)
```{r}
url <- "https://tinyurl.com/gradeinput"
gradebook <- read.csv(url, row.names=1)

head(gradebook)
```
```{r}
results <- apply(gradebook,1,grade)
results
```

Q2. Using your grade() function and the supplied gradebook, Who is the top scoring student
overall in the gradebook? [3pts]

```{r}
which.max(results)
```



Q3. From your analysis of the gradebook, which homework was toughest on students (i.e. obtained
the lowest scores overall? [2pts]

```{r}
which.min(apply(gradebook,2,mean, na.rm=T))
```
```{r}
which.min(apply(gradebook,2, sum, na.rm=T))
```



Q4. Optional Extension: From your analysis of the gradebook, which homework was most
predictive of overall score (i.e. highest correlation with average grade score)? [1pt]

```{r}
#make all NA to zero
mask<- gradebook
mask[is.na(mask)]<-0
mask
#mask

```

we can use the `cor()` function for correlation analysis.
```{r}
cor(mask$hw5, results)
```
```{r}
corre<-function(mask){cor(mask, results)}
apply(mask,2,corre)
apply(mask,2,cor,results)
```



Q5. Make sure you save your Quarto document and can click the “Render” (or Rmarkdown”Knit”) button to generate a PDF foramt report without errors. Finally, submit your PDF
to gradescope. [1pt]



